# EduDAO 專案啟動說明

本文件旨在提供在本地開發環境中啟動、部署及運行 EduDAO 專案的完整步驟。

---

## **啟動步驟**

請依序開啟三個獨立的終端機視窗（建議使用 Git Bash），並分別執行以下指令。

### **視窗一：啟動本地區塊鏈**

此視窗負責運行一個本地的以太坊節點，模擬區塊鏈環境。

1.  開啟一個新的終端機視窗。
2.  執行以下指令以啟動 Anvil 本地測試鏈：
    ```bash
    anvil
    ```
    > **注意：** 此視窗在整個開發過程中需要保持開啟狀態。

---

### **視窗二：部署智能合約**

此視窗負責編譯和部署所有智能合約到上述的本地區塊鏈中。

1.  開啟第二個終端機視窗。
2.  進入 Solidity 專案目錄：
    ```bash
    cd Desktop/block/blockchain/Solidity/edu-support
    ```
3.  安裝或更新智能合約的相依套件：
    ```bash
    forge install OpenZeppelin/openzeppelin-contracts --no-commit
    ```
4.  清除舊的編譯產物（可解決因刪除檔案引發的錯誤）：
    ```bash
    forge clean
    ```
5.  編譯所有智能合約：
    ```bash
    forge build
    ```
6.  執行整合部署腳本，此腳本會將 `EduDAO` 和 `FundraiserFactory` 合約部署並正確地關聯起來：
    ```bash
    forge script script/DeployDAO.s.sol --rpc-url http://127.0.0.1:8545 --private-key 0xac0974bec39a17e36ba4a6b4d238ff944bacb478cbed5efcae784d7bf4f2ff80 --broadcast
    ```
    > **重要：** 執行成功後，終端機會顯示新部署的合約地址。請複製 `EduDAO` 和 `FundraiserFactory` 的地址，並手動更新到前端設定檔 `Web/edu-support-app/src/edu-support/abi/FundraiserFactory-addr.json` 和一個**新的** `Web/edu-support-app/src/edu-support/abi/EduDAO-addr.json` 檔案中。
    > 同時，每次部署後，都需要將最新的 ABI 檔案從 `Solidity/edu-support/out/` 目錄複製到前端的 `Web/edu-support-app/src/edu-support/abi/` 目錄下。
    > - `EduDAO.sol/EduDAO.json` -> `EduDAO-abi.json`
    > - `FundraiserFactory.sol/FundraiserFactory.json` -> `FundraiserFactory-abi.json`
    > - `Fundraiser.sol/Fundraiser.json` -> `Fundraiser-abi.json`

node extract-abi.js
---

### **視窗三：啟動前端應用**

此視窗負責啟動 React 前端開發伺服器。

1.  開啟第三個終端機視窗。
2.  進入前端專案目錄：
    ```bash
    cd Desktop/block/blockchain/Web/edu-support-app
    ```
3.  安裝所有定義在 `package.json` 中的前端相依套件：
    ```bash
    npm install
    ```
4.  安裝其他套件(照老師講義)
    ```bash
    npm install react-router-dom @mui/material @emotion/react @emotion/styled web3 cryptocompare big-integer
    ```
    > **注意：** 在部署完智能合約後，請記得執行 `node go.cjs` 來同步設定。

5.  **自動更新前端設定檔：**
    > 執行完部署腳本後，回到**視窗三**（前端應用的終端機），並執行以下指令。此指令會自動將最新的合約地址與 ABI 複製到前端專案中。
    ```bash
    node go.cjs
    ```

6.  啟動前端開發伺服器：
    ```bash
    npm run dev
    ```
    > **提示：** 啟動成功後，您會在終端機看到前端網站的本地網址，通常是 `http://localhost:5173`。請在瀏覽器中開啟此網址以與應用程式互動。 
    **注意** 不要執行node go.cjs，可能會覆蓋掉其他檔案